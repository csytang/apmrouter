<html>
	<head>
		<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
		<title>APMRouter Admin Root</title>		
		<link type="text/css" href="js/ui/css/sunny/jquery-ui-1.8.10.custom.css" rel="stylesheet" />
		<link type="text/css" href="css/apmr.css" rel="stylesheet" />
		<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
		<script type="text/javascript" src="js/ui/jquery-ui-1.8.9.custom.min.js"></script>
		<script type="text/javascript" src="js/jquery.apmr.js" ></script>
		<script type="text/javascript" src="js/sprintf.js" ></script>
		<script type="text/javascript" src="js/jstree/jquery.jstree.js"></script>
		<script type="text/javascript">
			jQuery(function($) {
				/*
				$('.csubscriber>img').bind("status.connected", function(e, status) {
					console.info("IMG [connected]:%s", status);
					return false;
				});
				*/
				
				$(document).bind("status.connected", function(e, status){
					console.info("status.connected Fired:%s", status);
					if(status) {
						$('.csubscriber>.csubscriber-off').addClass('csubscriber-on').removeClass('csubscriber-off')
						$('.csubscriber>.csubscriber-retry').addClass('csubscriber-on').removeClass('csubscriber-retry')
					} else {
						$('.csubscriber>.csubscriber-on').addClass('csubscriber-off').removeClass('csubscriber-on')
						$('.csubscriber>.csubscriber-retry').addClass('csubscriber-off').removeClass('csubscriber-retry')
					}
				});
				$(document).bind("status.reconnecting", function(e){
					console.info("status.reconnecting Fired");
					$('.csubscriber>.csubscriber-off').addClass('csubscriber-retry').removeClass('csubscriber-off')
				});
				
				
				$.apmr.connect(); 
				$('#metricTree')
				.jstree({
					core : {  },
					plugins : [ "themes", "ui", "types", "html_data" ],
					types : {
						'types' : {
				            'root' : {
				                'icon' : {
				                    'image' : 'img/Helios_Symbol_12_18.png'
				                }
				            },
				            'server' : {
				                'icon' : {
				                    'image' : 'img/server.png'
				                }
				            }
				        }						
					}
				});
			});
		</script>		
	</head>
	<body>
		<h4>APMRouter Admin Root</h4>		
		<div class="csubscriber" style="display: inline-block;">Connected:&nbsp;<div class="csubscriber-off"></div></div>
		<h5>Metric Tree</h5>
		<div id="metricTree">
			<ul>
				<li rel='root'><a>Metric Tree</a></li>
			</ul>
		</div>
	</body>
</html>

<!-- 

	<script type="text/javascript">	
	    var reqId = 0;
		var ws;
		var r = "{t:'req', svc:'hostagent', op:'listhosts'}";
		var r2 = "{t:'req', svc:'hostagent', op:'listhosts', args:[false]}";
		function startWebSocket() {
			var wsUrl = 'ws://' + document.location.host + '/ws';
			//console.info('WebSocket URL:[%s]', wsUrl);
			ws = new WebSocket(wsUrl); 
			ws.onopen = function() {
			    console.info("WebSocket Opened");
			    sendWho();
			    // navigator.userAgent
			    //ws.send("{t :'who',agent:''}");
			}; 
			ws.onerror = function(e) {
				console.info("WebSocket Error");
				console.dir(e);
			}; 
			ws.onclose = function() { 			
				console.info("WebSocket Closed"); 
			}; 
			ws.onmessage = function(msg) {			
				try {
					var json = JSON.parse(msg.data);
					console.dir(json);
				} finally {
				}
			}; 
		}	
		function send(req) {
			reqId++;
			req['rid']=reqId;
			ws.send(JSON.stringify(req));
			return reqId;
		}
		
		function sendWho() {
			return send({'t': 'who', 'agent' : 'Anonymous'});
		}
		
		function svcOp(svc, op) {
			var req = {'t': 'req', 'svc' : svc, 'op' : op};
			return send(req);
		}
	</script>

	{t:'req', svc:'catalog', op:'nq', args:{name:'findAgentsByHost', p:{hostId:1}}}


 -->